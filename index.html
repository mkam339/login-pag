<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ø·ÙˆÙŠÙ‚ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© â€” Ù†Ù…ÙˆØ°Ø¬ ÙˆØ§Ø¬Ù‡Ø© (Ù…Ø¹Ø¯Ù‘Ù„)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{ --primary:#55AB77; --text:#111111; --muted:#6b7280; }
    body { font-family: 'Tajawal', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; color:var(--text); background:#fff; }
    .brand { color:var(--primary); font-weight:800; letter-spacing:1px; }
    .card-shadow { box-shadow: 0 6px 20px rgba(16,24,40,0.06); }
    .btn-primary { background:var(--primary); color:white; }
    .btn-primary:hover { background:#449a63; }
    .correct-badge { background:var(--primary); color:#fff; padding:3px 8px; border-radius:999px; font-size:12px; }
    .hidden { display:none; }
    .thumb { width:120px; height:80px; object-fit:cover; border-radius:6px; border:1px solid #e5e7eb; }
  </style>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyB4_41AcIGnlxFVT7XYGfFFCtGQZmFj0tI",
  authDomain: "tawiq-f8d65.firebaseapp.com",
  databaseURL: "https://tawiq-f8d65-default-rtdb.firebaseio.com",
  projectId: "tawiq-f8d65",
  storageBucket: "tawiq-f8d65.firebasestorage.app",
  messagingSenderId: "47258312484",
  appId: "1:47258312484:web:588d01bd2d7fd560e49db1",
  measurementId: "G-4JXWGDD0HY"
};
const app = firebase.initializeApp(firebaseConfig);
const analytics = firebase.analytics();
const db = firebase.database();
</script>


<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

</head>
<body class="antialiased">
  <!-- NAVBAR -->
  <nav class="bg-white border-b">
    <div class="container mx-auto px-6 py-4 flex items-center justify-between">
      <div class="flex items-center gap-4">
        <img id="logo" src="https://i.ibb.co/Cpc7k6bM/Screenshot-2025-08-10-135424.png=Ø·ÙˆÙŠÙ‚" alt="logo" class="h-10">
        <div>
        </div>
      </div>

      <div class="hidden md:flex items-center gap-6">
        <a href="https://t.me/tawiqKSA" class="text-sm text-gray-700 hover:text-black">ØªÙˆØ§ØµÙ„</a>
      </div>

      <div class="flex items-center gap-3">
        <button id="btnLogin" class="text-sm px-4 py-2 border rounded hover:bg-gray-50">ØªØ³Ø¬ÙŠÙ„/Ø¯Ø®ÙˆÙ„</button>
        <button id="btnDashboard" class="text-sm px-4 py-2 btn-primary rounded hidden">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù</button>
      </div>
    </div>
  </nav>

  <!-- HERO -->
  <header class="container mx-auto px-6 py-12">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
      <div>

        <div class="mt-6 flex gap-3">
        </div>
      </div>

     
    </div>
  </header>
<center>
  <div style="position: relative; display: inline-block;">
  <!-- Ø§Ù„ØµÙˆØ±Ø© -->
  <img src="https://i.ibb.co/35Pc5r1L/Whats-App-Image-2025-08-12-at-01-42-07-61c33bae.jpg" alt="ØµÙˆØ±Ø©" style="display: block; max-width: 100%;">

  <!-- Ø²Ø± Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
  <a href="https://t.me/tawiqKSA"
     style="
       position: absolute;
       top: 78%;
       right: 5%;
       width: 160px;
       height: 55px;
       background: linear-gradient(to right, #15b39a, #00d084);
       color: white;
       font-family: Arial, sans-serif;
       font-size: 20px;
       font-weight: bold;
       text-decoration: none;
       border-radius: 30px;
       display: flex;
       align-items: center;
       justify-content: center;
     ">
    Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
  </a>

  <!-- Ø²Ø± ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† -->
  <a href="https://example.com/subscribers"
     style="
       position: absolute;
       top: 78%;
       left: 5%;
       width: 160px;
       height: 55px;
       background: linear-gradient(to right, #15b39a, #00d084);
       color: white;
       font-family: Arial, sans-serif;
       font-size: 20px;
       font-weight: bold;
       text-decoration: none;
       border-radius: 30px;
       display: flex;
       align-items: center;
       justify-content: center;
     ">
    ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†
  </a>
</div>
</center>
  <!-- COURSES SECTION -->
  <section id="courses" class="container mx-auto px-6 pb-12">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-2xl font-bold">Ø£Ø­Ø¯Ø« Ø§Ù„Ø¯ÙˆØ±Ø§Øª</h2>
      <!-- ØªÙ… Ø­Ø°Ù Ø®Ø§Ù†Ø© Ø§Ù„Ø¨Ø­Ø« Ø¨Ø­Ø³Ø¨ Ø§Ù„Ø·Ù„Ø¨ -->
    </div>

    <div id="coursesContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      <!-- populated by JS -->
    </div>

    <!-- Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø«Ø§Ø¨ØªØ© Ø§Ù„Ù…Ø±Ø³Ù„Ø© Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø³ÙÙ„ Ø§Ù„Ø¯ÙˆØ±Ø§Øª -->
    <div class="mt-8">
      <h3 class="text-lg font-semibold mb-3">ØµÙˆØ±Ø© ØªÙˆØ¶ÙŠØ­ÙŠØ©</h3>
      <img src="/mnt/data/4f66b722-edb6-45f6-8ab1-96e774620e20.jpg" alt="Ø§Ù„Ø§Ø®Ø¨Ø§Ø±" class="w-full rounded card-shadow" />
      <!-- Ø¥Ø°Ø§ Ù„Ù… ØªØ¸Ù‡Ø± Ø§Ù„ØµÙˆØ±Ø© Ù„Ø£Ù† Ø§Ù„Ù…Ø³Ø§Ø± Ù…Ø­Ù„ÙŠØŒ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ø§Ø¨Ø· Ø¨Ø¯ÙŠÙ„ -->
      <noscript class="text-sm text-gray-500">Ù‚Ø¯ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ù…Ø­Ù„ÙŠÙ‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø± Ø£Ø¹Ù„Ø§Ù‡ Ø£Ùˆ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø± Ù„ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø¨ÙŠØ¦ØªÙƒ.</noscript>
    </div>
  </section>

  <!-- COURSE DETAIL (modal/panel) -->
  <div id="courseDetail" class="fixed inset-0 bg-black/40 hidden items-center justify-center p-6">
    <div class="bg-white rounded-lg w-full max-w-4xl overflow-hidden shadow-xl">
      <div class="flex justify-between items-center p-4 border-b">
        <h3 id="detailTitle" class="text-xl font-bold"></h3>
        <button onclick="closeDetail()" class="px-6 py-2 border rounded text-sm">X Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
      <div class="p-6 grid grid-cols-1 lg:grid-cols-3 gap-6">
        <div class="lg:col-span-1">
          <img id="detailImage" src="https://placehold.co/600x400" alt="" class="rounded-lg w-full">
          <div class="mt-4">
            <div class="text-2xl font-bold text-gray-800" id="detailPrice"></div>
            <div class="text-sm text-gray-500">Ù…Ø¯Ø© Ø§Ù„Ø¯ÙˆØ±Ø©: <span id="detailDuration">â€”</span></div>
            <div class="mt-3">
              <button class="w-full py-2 btn-primary rounded" onclick="buyCourse()">Ø§Ø´ØªØ±Ù Ø§Ù„Ø¢Ù†</button>
            </div>
          </div>
        </div>
        <div class="lg:col-span-2">
          <h4 class="font-semibold">Ø§Ù„ÙˆØµÙ</h4>
          <p id="detailDesc" class="mt-2 text-gray-700"></p>

          <h4 class="font-semibold mt-6">Ù…Ø§ Ø³ØªØªØ¹Ù„Ù…Ù‡</h4>
          <ul id="detailWhat" class="list-disc list-inside mt-2 text-gray-700"></ul>

          <h4 class="font-semibold mt-6">Ø§Ù„Ø­Ø§Ù„Ø©</h4>
          <div id="detailSaleState" class="mt-2 text-sm text-gray-600"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- MY COURSES (hidden panel) -->
  <section id="myCourses" class="container mx-auto px-6 py-12 hidden">
    <div class="flex justify-between items-center mb-6">
      <h2 class="text-2xl font-bold">Ø¯ÙˆØ±Ø§ØªÙŠ</h2>
      <div>
        <button onclick="goHome()" class="px-4 py-2 border rounded">Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
      </div>
    </div>

    <div id="myCoursesContainer" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
  </section>

  <!-- AFTER PAYMENT -->
  <section id="postPayment" class="container mx-auto px-6 py-12 hidden">
    <div class="bg-white p-6 rounded-lg card-shadow">
      <div class="flex justify-between items-center">
        <h2 class="text-xl font-bold">Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø¯ÙØ¹ â€” Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„Ø¢Ù†</h2>
        <div>
          <button class="px-4 py-2 rounded border" onclick="goHome()">Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
        </div>
      </div>

      <p class="mt-3 text-gray-600">Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ù…ØªØ§Ø­Ø© Ù„Ùƒ. ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø´Ø±Ù ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù.</p>

      <div id="courseButtons" class="mt-6 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3"></div>
    </div>
  </section>

  <!-- ADMIN PANEL (UI-only) -->
  <section id="adminPanel" class="container mx-auto px-6 py-12 hidden">
    <div class="flex justify-between items-center mb-6">
      <h2 class="text-2xl font-bold">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù</h2>
      <div>
        <button onclick="goHome()" class="px-4 py-2 border rounded">Ø®Ø±ÙˆØ¬</button>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- Courses manager -->
      <div class="bg-white p-6 rounded-lg card-shadow">
        <h3 class="font-semibold mb-4">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ±Ø§Øª</h3>

        <div class="grid grid-cols-1 gap-2 mb-4">
          <input id="cTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯ÙˆØ±Ø©" class="px-3 py-2 border rounded w-full" />
          <input id="cPrice" type="number" min="0" placeholder="Ø§Ù„Ø³Ø¹Ø± (Ø±.Ø³)" class="px-3 py-2 border rounded w-full" />
          <textarea id="cDesc" placeholder="ÙˆØµÙ Ø§Ù„Ø¯ÙˆØ±Ø©" class="px-3 py-2 border rounded w-full"></textarea>
          <input id="cDuration" placeholder="Ø§Ù„Ù…Ø¯Ø© (Ù…Ø«Ù„Ø§Ù‹: 10 Ø³Ø§Ø¹Ø§Øª)" class="px-3 py-2 border rounded w-full" />
          <label class="text-sm">ØµÙˆØ±Ø© Ø§Ù„Ø¯ÙˆØ±Ø© (Ø§Ø®ØªÙØ± Ù…Ù„ÙÙ‹Ø§ Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ Ø£Ùˆ Ø¶Ø¹ Ø±Ø§Ø¨Ø·Ù‹Ø§)</label>
          <div class="flex gap-2">
            <input id="cImageUrl" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (URL)" class="px-3 py-2 border rounded w-full" />
            <input id="cImageFile" type="file" accept="image/*" class="px-3 py-2 border rounded" />
          </div>
          <select id="cSaleState" class="px-3 py-2 border rounded w-full">
            <option value="before">Ù‚Ø¨Ù„ Ø§Ù„Ø¹Ø±Ø¶</option>
            <option value="after">Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ø±Ø¶</option>
          </select>

          <div class="flex gap-2">
            <button class="px-4 py-2 btn-primary rounded" onclick="adminAddCourse()">Ø¥Ø¶Ø§ÙØ© / Ø­ÙØ¸</button>
            <button class="px-4 py-2 border rounded" onclick="adminClearCourseForm()">Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„</button>
          </div>
        </div>

        <div id="adminCoursesList" class="mt-4 space-y-2"></div>
      </div>

      <!-- News images manager -->
      <div class="bg-white p-6 rounded-lg card-shadow">
        <h3 class="font-semibold mb-4">Ø¥Ø¯Ø§Ø±Ø© ØµÙˆØ± Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</h3>

        <div class="mb-3">
          <label class="text-sm">Ø±ÙØ¹ ØµÙˆØ±Ø© Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ</label>
          <input id="newsFile" type="file" accept="image/*" class="mt-2" />
        </div>
        <div class="mb-3">
          <label class="text-sm">Ø£Ùˆ Ø¶Ø¹ Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø©</label>
          <input id="newsUrl" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©" class="px-3 py-2 border rounded w-full" />
        </div>
        <div class="flex gap-2">
          <button class="px-4 py-2 btn-primary rounded" onclick="addNewsImageFromFile()">Ø±ÙØ¹ Ù…Ù† Ø¬Ù‡Ø§Ø²</button>
          <button class="px-4 py-2 border rounded" onclick="addNewsImageFromUrl()">Ø¥Ø¶Ø§ÙØ© Ù…Ù† Ø±Ø§Ø¨Ø·</button>
        </div>

        <div id="newsList" class="mt-4 grid grid-cols-2 gap-3"></div>
      </div>
    </div>

    <!-- Sales preview -->
    <div class="mt-8 bg-white p-6 rounded-lg card-shadow">
      <h3 class="font-semibold mb-3">Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª (Ù…Ø­Ø§ÙƒØ§Ø©)</h3>
      <div id="salesList" class="text-sm text-gray-600">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨ÙŠØ¹Ø§Øª Ø¨Ø¹Ø¯.</div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="border-t mt-12">
    <div class="container mx-auto px-6 py-6 text-center text-sm text-gray-600">
      Â© 2025 Ø·ÙˆÙŠÙ‚ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© â€” ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©
    </div>
  </footer>

  <!-- LOGIN / REGISTER MODAL (updated form) -->
  <div id="authModal" class="fixed inset-0 bg-black/40 hidden items-center justify-center p-4">
    <div class="bg-white rounded-lg w-full max-w-md p-6">
      <div class="flex justify-between items-center">
        <h3 id="authTitle" class="text-lg font-semibold">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
        <button onclick="closeAuth()">âœ•</button>
      </div>

      <div id="authBody" class="mt-4">
        <!-- LOGIN FORM -->
        <form id="loginForm" onsubmit="event.preventDefault(); doLogin();">
          <input id="authEmail" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" class="w-full px-3 py-2 border rounded mb-2" />
          <input id="authPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" type="password" class="w-full px-3 py-2 border rounded mb-2" />
          <div class="flex gap-2">
            <button type="submit" class="px-4 py-2 btn-primary rounded">Ø¯Ø®ÙˆÙ„</button>
            <button type="button" class="px-4 py-2 border rounded" onclick="showRegisterForm()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
          </div>
          <div class="mt-3 text-sm text-gray-600">ØªØ³Ø¬ÙŠÙ„ Ù…Ø¨Ø¯Ø¦ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… localStorage (Ù†Ù…ÙˆØ°Ø¬ ÙÙ‚Ø·).</div>
        </form>

        <!-- REGISTER FORM (hidden initially) -->
        <form id="registerForm" class="hidden" onsubmit="event.preventDefault(); doRegister();">
          <input id="regEmail" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" class="w-full px-3 py-2 border rounded mb-2" required />
          <input id="regUsername" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" class="w-full px-3 py-2 border rounded mb-2" required />
          <input id="regPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" type="password" class="w-full px-3 py-2 border rounded mb-2" required />
          <input id="regAdminCode" placeholder="Ø±Ù…Ø² Ø§Ù„Ù…Ø´Ø±Ù (Ø¥Ø°Ø§ ÙˆÙØ¬Ø¯)" class="w-full px-3 py-2 border rounded mb-2" />
          <div class="flex gap-2">
            <button type="submit" class="px-4 py-2 btn-primary rounded">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
            <button type="button" class="px-4 py-2 border rounded" onclick="showLoginForm()">Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯Ø®ÙˆÙ„</button>
          </div>
          <div class="mt-2 text-sm text-gray-500">Ø¥Ø°Ø§ Ø£Ø¯Ø®Ù„Øª Ø±Ù…Ø² Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„ØµØ­ÙŠØ­ Ø³ÙŠØªÙ… Ù…Ù†Ø­Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ù…Ø´Ø±Ù.</div>
        </form>
      </div>
    </div>
  </div>

<script>
  /*********************
   * Admin code value
   *********************/
  const ADMIN_CODE = 'moshrif192837465';

  /*********************
   * Load persisted data or defaults
   *********************/
  let courses = JSON.parse(localStorage.getItem('coursesData') || 'null');
  if(!courses){
    courses = [
      { id:1, title:'Ø¯ÙˆØ±Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…', price:199, image:'https://placehold.co/800x500?text=Ù‚ÙŠØ§Ø³', desc:'ØªØ­Ø¶ÙŠØ± Ø´Ø§Ù…Ù„ Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù‚ÙŠØ§Ø³ Ù…Ø¹ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©.', duration:'12 Ø³Ø§Ø¹Ø©', saleState:'before', what:['Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„Ù‚ÙŠØ§Ø³','Ø£Ø³Ø§Ù„ÙŠØ¨ Ø­Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©','Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø²Ù…Ù†ÙŠØ©'], tests:[{id:'t1',title:'Ø§Ø®ØªØ¨Ø§Ø± ÙƒÙ…ÙŠ'}] },
      { id:2, title:'Ø¯ÙˆØ±Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©', price:99, image:'https://placehold.co/800x500?text=Ø¹Ø±Ø¨ÙŠ', desc:'ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù„ØºÙˆÙŠØ© ÙˆØ§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù„ÙØ¸ÙŠØ© Ù…ÙƒØ«ÙØ©.', duration:'8 Ø³Ø§Ø¹Ø§Øª', saleState:'after', what:['Ù‚ÙˆØ§Ø¹Ø¯','Ù‚Ø±Ø§Ø¡Ø©','ØªÙ…Ø§Ø±ÙŠÙ† Ù„ÙØ¸ÙŠ'], tests:[{id:'t2',title:'Ø§Ø®ØªØ¨Ø§Ø± Ù„ÙØ¸ÙŠ'}] },
      { id:3, title:'Ø¯ÙˆØ±Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©', price:149, image:'https://placehold.co/800x500?text=Ø±ÙŠØ§Ø¶ÙŠØ§Øª', desc:'Ø¯ÙˆØ±Ø© ØªØºØ·ÙŠ Ù…ÙØ§Ù‡ÙŠÙ… Ø±ÙŠØ§Ø¶ÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø© Ù…Ø¹ Ø­Ù„ Ù…Ø³Ø§Ø¦Ù„.', duration:'10 Ø³Ø§Ø¹Ø§Øª', saleState:'before', what:['Ø¬Ø¨Ø±','Ù‡Ù†Ø¯Ø³Ø©','Ø¥Ø­ØµØ§Ø¡'], tests:[] }
    ];
    localStorage.setItem('coursesData', JSON.stringify(courses));
  }

  let courseButtons = JSON.parse(localStorage.getItem('courseButtons') || '[]');
  let adminQuestions = JSON.parse(localStorage.getItem('adminQuestions') || '[]');
  let sales = JSON.parse(localStorage.getItem('sales') || '[]');
  let newsImages = JSON.parse(localStorage.getItem('newsImages') || '[]');

  /*********************
   * Utilities & routing
   *********************/
  function goHome(){ showSection('home'); document.getElementById('courses').scrollIntoView(); }
  function goToMyCourses(){ renderMyCourses(); showSection('myCourses'); }
  function showSection(s){
    document.getElementById('courses').style.display = (s==='home' ? 'block':'none');
    document.getElementById('myCourses').classList.toggle('hidden', s!=='myCourses');
    document.getElementById('postPayment').classList.toggle('hidden', s!=='postPayment');
    document.getElementById('adminPanel').classList.toggle('hidden', s!=='admin');
    if(s==='home' || s===undefined){ document.getElementById('courses').style.display='block'; document.getElementById('myCourses').classList.add('hidden'); document.getElementById('postPayment').classList.add('hidden'); document.getElementById('adminPanel').classList.add('hidden'); }
  }

  /*********************
   * Render courses (no search)
   *********************/
  function renderCourses(){
    const container = document.getElementById('coursesContainer');
    container.innerHTML = '';
    courses.forEach(c=>{
      const el = document.createElement('div');
      el.className = 'bg-white rounded-lg overflow-hidden card-shadow';
      el.innerHTML = `
        <img src="${c.image}" class="w-full h-40 object-cover" onerror="this.src='https://placehold.co/800x500?text=image+not+found';" />
        <div class="p-4">
          <h3 class="font-semibold text-lg">${c.title}</h3>
          <p class="text-sm text-gray-600 mt-2 line-clamp-3">${c.desc}</p>
          <div class="mt-2 text-xs text-gray-500">Ø§Ù„Ø­Ø§Ù„Ø©: ${c.saleState === 'before' ? 'Ù‚Ø¨Ù„ Ø§Ù„Ø¹Ø±Ø¶' : 'Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ø±Ø¶'}</div>
          <div class="mt-4 flex items-center justify-between">
            <div><span class="text-xl font-bold">${c.price}</span> <span class="text-sm text-gray-500">Ø±.Ø³</span></div>
            <div class="flex gap-2">
              <button class="px-3 py-1 border rounded text-sm" onclick="openDetail(${c.id})">ØªÙØ§ØµÙŠÙ„</button>
              <button class="px-3 py-1 btn-primary rounded text-sm" onclick="quickBuy(${c.id})">Ø§Ø´ØªØ±ÙŠ</button>
            </div>
          </div>
        </div>`;
      container.appendChild(el);
    });
  }

  function openDetail(id){
    const c = courses.find(x=>x.id===id);
    if(!c) return;
    document.getElementById('detailTitle').innerText = c.title;
    document.getElementById('detailImage').src = c.image;
    document.getElementById('detailDesc').innerText = c.desc;
    document.getElementById('detailPrice').innerText = c.price + ' Ø±.Ø³';
    document.getElementById('detailDuration').innerText = c.duration;
    const what = document.getElementById('detailWhat'); what.innerHTML = ''; (c.what||[]).forEach(i=> what.innerHTML+=`<li>${i}</li>`);
    document.getElementById('detailSaleState').innerText = c.saleState === 'before' ? 'Ù‚Ø¨Ù„ Ø§Ù„Ø¹Ø±Ø¶' : 'Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ø±Ø¶';
    document.getElementById('courseDetail').classList.remove('hidden'); document.getElementById('courseDetail').style.display='flex';
    document.getElementById('courseDetail').dataset.courseId = id;
  }
  function closeDetail(){ document.getElementById('courseDetail').classList.add('hidden'); }

  /*********************
   * Purchase flow (simulated)
   *********************/
  function quickBuy(id){
    const cobj = courses.find(c=>c.id===id);
    const sale = { id: Date.now(), courseId:id, amount: cobj.price, status:'paid', at: Date.now(), user: getCurrentUser() ? getCurrentUser().email : 'guest' };
    sales.push(sale); localStorage.setItem('sales', JSON.stringify(sales));
    let my = JSON.parse(localStorage.getItem('myCourses') || '[]');
    if(!my.find(m=>m.courseId===id)) my.push({ courseId:id, purchasedAt: Date.now()});
    localStorage.setItem('myCourses', JSON.stringify(my));
    renderCourseButtons(); renderSales();
    showSection('postPayment');
  }
  function buyCourse(){ const id = parseInt(document.getElementById('courseDetail').dataset.courseId); quickBuy(id); }

  /*********************
   * My courses
   *********************/
  function renderMyCourses(){
    const container = document.getElementById('myCoursesContainer');
    container.innerHTML = '';
    const my = JSON.parse(localStorage.getItem('myCourses') || '[]');
    if(!my.length){ container.innerHTML = '<div class="text-gray-600">Ù„Ù… ØªØ´ØªØ±Ù Ø£ÙŠ Ø¯ÙˆØ±Ø§Øª Ø¨Ø¹Ø¯.</div>'; return; }
    my.forEach(entry=>{
      const c = courses.find(x=>x.id===entry.courseId);
      const el = document.createElement('div'); el.className='bg-white p-4 rounded-lg flex gap-4 items-center card-shadow';
      el.innerHTML = `<img src="${c.image}" class="w-28 h-20 object-cover rounded"><div class="flex-1"><h4 class="font-semibold">${c.title}</h4><div class="text-sm text-gray-500">ØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡: ${new Date(entry.purchasedAt).toLocaleString()}</div></div><div><button class="px-3 py-2 btn-primary rounded" onclick="enterCourse(${c.id})">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¯ÙˆØ±Ø©</button></div>`;
      container.appendChild(el);
    });
  }
  function enterCourse(courseId){ renderCourseButtons(); showSection('postPayment'); }

  /*********************
   * Course Buttons (admin managed)
   *********************/
  function renderCourseButtons(){
    const wrap = document.getElementById('courseButtons'); wrap.innerHTML = '';
    if(!courseButtons.length){ wrap.innerHTML = '<div class="text-gray-600">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø²Ø±Ø§Ø± Ù…ÙØ¶Ø§ÙØ© Ø¨Ø¹Ø¯ â€” Ø§Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ù…Ø´Ø±Ù Ø¥Ø¶Ø§ÙØªÙ‡Ø§.</div>'; return; }
    courseButtons.forEach((b,idx)=>{
      const el = document.createElement('div'); el.className='p-4 bg-white rounded-lg flex items-center justify-between card-shadow';
      el.innerHTML = `<div><div class="font-semibold">${b.title}</div><div class="text-sm text-gray-500">${b.url}</div></div><div class="flex gap-2"><a target="_blank" href="${b.url}" class="px-3 py-2 btn-primary rounded text-sm">Ø§ÙØªØ­</a></div>`;
      wrap.appendChild(el);
    });
  }

  /*********************
   * Admin: Courses CRUD
   *********************/
  function adminAddCourse(){
    // read form
    const title = document.getElementById('cTitle').value.trim();
    const price = parseFloat(document.getElementById('cPrice').value || 0);
    const desc = document.getElementById('cDesc').value.trim();
    const duration = document.getElementById('cDuration').value.trim();
    const url = document.getElementById('cImageUrl').value.trim();
    const fileInput = document.getElementById('cImageFile');
    const saleState = document.getElementById('cSaleState').value;

    if(!title){ alert('Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯ÙˆØ±Ø©'); return; }

    // handle file => convert to dataURL if provided
    if(fileInput.files && fileInput.files[0]){
      const f = fileInput.files[0];
      const reader = new FileReader();
      reader.onload = function(e){
        const dataUrl = e.target.result;
        pushCourseToList({ title, price, desc, duration, image: dataUrl, saleState });
      };
      reader.readAsDataURL(f);
    } else {
      // use url or placeholder
      pushCourseToList({ title, price, desc, duration, image: url || 'https://placehold.co/800x500?text=new+course', saleState });
    }
  }

  function pushCourseToList(courseObj){
    // if editing (we store editing id in form dataset)
    const editingId = document.getElementById('cTitle').dataset.editing;
    if(editingId){
      const idx = courses.findIndex(c=>c.id==editingId);
      if(idx>-1){
        courses[idx] = { ...courses[idx], ...courseObj };
        alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¯ÙˆØ±Ø©');
      }
      delete document.getElementById('cTitle').dataset.editing;
    } else {
      const newId = Date.now();
      courses.push({ id:newId, title:courseObj.title, price:courseObj.price||0, desc:courseObj.desc||'', duration:courseObj.duration||'', image:courseObj.image, saleState:courseObj.saleState||'before', what:[], tests:[] });
      alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙˆØ±Ø©');
    }
    localStorage.setItem('coursesData', JSON.stringify(courses));
    adminClearCourseForm();
    renderCourses();
    renderAdminCoursesList();
  }

  function adminClearCourseForm(){
    document.getElementById('cTitle').value=''; document.getElementById('cPrice').value=''; document.getElementById('cDesc').value=''; document.getElementById('cDuration').value=''; document.getElementById('cImageUrl').value=''; document.getElementById('cImageFile').value=''; document.getElementById('cSaleState').value='before';
    delete document.getElementById('cTitle').dataset.editing;
  }

  function renderAdminCoursesList(){
    const list = document.getElementById('adminCoursesList'); list.innerHTML='';
    courses.slice().reverse().forEach((c)=>{
      const row = document.createElement('div'); row.className='p-3 border rounded flex items-center justify-between';
      row.innerHTML = `<div class="flex items-center gap-3"><img src="${c.image}" class="thumb" onerror="this.src='https://placehold.co/120x80?text=NA'"><div><div class="font-semibold">${c.title}</div><div class="text-xs text-gray-500">Ø§Ù„Ø³Ø¹Ø±: ${c.price} Ø±.Ø³ â€” Ø§Ù„Ø­Ø§Ù„Ø©: ${c.saleState==='before' ? 'Ù‚Ø¨Ù„ Ø§Ù„Ø¹Ø±Ø¶' : 'Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ø±Ø¶'}</div></div></div>
        <div class="flex flex-col gap-2">
          <button class="px-3 py-1 border rounded text-sm" onclick="adminEditCourse(${c.id})">ØªØ¹Ø¯ÙŠÙ„</button>
          <button class="px-3 py-1 border rounded text-sm" onclick="adminDeleteCourse(${c.id})">Ø­Ø°Ù</button>
        </div>`;
      list.appendChild(row);
    });
  }

  function adminEditCourse(id){
    const c = courses.find(x=>x.id===id);
    if(!c) return;
    document.getElementById('cTitle').value = c.title; document.getElementById('cPrice').value = c.price; document.getElementById('cDesc').value=c.desc; document.getElementById('cDuration').value=c.duration; document.getElementById('cImageUrl').value = c.image; document.getElementById('cSaleState').value = c.saleState;
    document.getElementById('cTitle').dataset.editing = c.id;
    window.scrollTo({ top: document.getElementById('adminPanel').offsetTop, behavior:'smooth' });
  }

  function adminDeleteCourse(id){
    if(!confirm('Ù‡Ù„ ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆØ±Ø©ØŸ')) return;
    courses = courses.filter(c=>c.id!==id);
    localStorage.setItem('coursesData', JSON.stringify(courses));
    renderCourses(); renderAdminCoursesList();
    alert('ØªÙ… Ø§Ù„Ø­Ø°Ù');
  }

  /*********************
   * News images manager (local files or URL)
   *********************/
  function addNewsImageFromFile(){
    const finput = document.getElementById('newsFile');
    if(!finput.files || !finput.files[0]){ alert('Ø§Ø®ØªØ± Ù…Ù„ÙÙ‹Ø§ Ø£ÙˆÙ„Ù‹Ø§'); return; }
    const f = finput.files[0];
    const reader = new FileReader();
    reader.onload = function(e){
      const dataUrl = e.target.result;
      newsImages.push({ id: Date.now(), src: dataUrl });
      localStorage.setItem('newsImages', JSON.stringify(newsImages));
      renderNewsList();
      finput.value = '';
    };
    reader.readAsDataURL(f);
  }

  function addNewsImageFromUrl(){
    const url = document.getElementById('newsUrl').value.trim();
    if(!url){ alert('Ø¶Ø¹ Ø±Ø§Ø¨Ø·Ù‹Ø§'); return; }
    newsImages.push({ id: Date.now(), src: url });
    localStorage.setItem('newsImages', JSON.stringify(newsImages));
    renderNewsList();
    document.getElementById('newsUrl').value='';
  }

  function renderNewsList(){
    const wrap = document.getElementById('newsList'); wrap.innerHTML='';
    if(!newsImages.length){ wrap.innerHTML = '<div class="text-gray-600">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ± Ø£Ø®Ø¨Ø§Ø± Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯.</div>'; return; }
    newsImages.slice().reverse().forEach(img=>{
      const el = document.createElement('div'); el.className='p-2 border rounded flex items-center justify-between gap-2';
      el.innerHTML = `<img src="${img.src}" class="thumb" onerror="this.src='https://placehold.co/120x80?text=NA'"><div class="flex flex-col gap-2"><button class="px-3 py-1 border rounded text-sm" onclick='viewImage("${img.src.replace(/"/g,'&quot;')}")'>Ø¹Ø±Ø¶</button><button class="px-3 py-1 border rounded text-sm" onclick="removeNewsImage(${img.id})">Ø­Ø°Ù</button></div>`;
      wrap.appendChild(el);
    });
  }

  function removeNewsImage(id){
    if(!confirm('Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„ØµÙˆØ±Ø©ØŸ')) return;
    newsImages = newsImages.filter(i=>i.id!==id);
    localStorage.setItem('newsImages', JSON.stringify(newsImages));
    renderNewsList();
  }

  function viewImage(src){
    // Ø¹Ø±Ø¶ Ø¨Ø³ÙŠØ· ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø©
    const w = window.open('');
    w.document.write(`<img src="${src}" style="max-width:100%;height:auto" />`);
  }

  /*********************
   * Admin questions & sales (existing)
   *********************/
  function renderAdminQuestions(){
    const list = document.getElementById('adminQuestionsList'); if(!list) return;
    list.innerHTML='';
    adminQuestions.forEach((q,i)=>{
      const el = document.createElement('div'); el.className='p-3 border rounded flex items-start justify-between';
      el.innerHTML = `<div><div class="font-semibold">${q.testName}</div><div class="text-sm mt-1">${q.text}</div><div class="mt-2 text-xs text-gray-500">Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª: ${q.options.join(' | ')}</div><div class="mt-2"><span class="correct-badge">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©: Ø®ÙŠØ§Ø± ${parseInt(q.correct)+1}</span> <span class="text-xs text-gray-500 ml-2">ÙˆÙ‚Øª: ${q.time || 'Ù…ÙØªÙˆØ­'}</span></div></div><div><button class="px-3 py-1 border rounded" onclick="removeQuestion(${i})">Ø­Ø°Ù</button></div>`;
      list.appendChild(el);
    });
  }
  function addQuestion(){
    const testName = document.getElementById('qTest').value.trim() || 'Ø¹Ø§Ù…';
    const text = document.getElementById('qText').value.trim(); 
    const options = [document.getElementById('opt1').value,document.getElementById('opt2').value,document.getElementById('opt3').value,document.getElementById('opt4').value].map(s=>s||'â€”');
    const correct = document.getElementById('correctIndex').value;
    const time = document.getElementById('qTime').value || null;
    if(!text){ alert('Ø£Ø¯Ø®Ù„ Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„'); return; }
    adminQuestions.push({ testName, text, options, correct, time });
    localStorage.setItem('adminQuestions', JSON.stringify(adminQuestions));
    renderAdminQuestions();
  }
  function clearQuestions(){ if(!confirm('Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©ØŸ')) return; adminQuestions=[]; localStorage.setItem('adminQuestions','[]'); renderAdminQuestions(); }
  function removeQuestion(i){ adminQuestions.splice(i,1); localStorage.setItem('adminQuestions', JSON.stringify(adminQuestions)); renderAdminQuestions(); }

  /*********************
   * Sales rendering
   *********************/
  function renderSales(){
    const el = document.getElementById('salesList');
    if(!sales.length) { el.innerText = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨ÙŠØ¹Ø§Øª Ø¨Ø¹Ø¯.'; return; }
    el.innerHTML = '';
    sales.slice().reverse().forEach(s=>{
      const c = courses.find(x=>x.id===s.courseId) || {title:'(Ø¯ÙˆØ±Ø© Ù…Ø­Ø°ÙˆÙØ©)'};
      const row = document.createElement('div'); row.className='flex items-center justify-between py-2 border-b';
      row.innerHTML = `<div class="text-sm">${c.title} â€” ${s.user}</div><div class="text-sm text-gray-500">${new Date(s.at).toLocaleString()} â€” ${s.amount} Ø±.Ø³</div>`;
      el.appendChild(row);
    });
  }

  /*********************
   * Auth (localStorage) with admin code check
   *********************/
  function getCurrentUser(){ return JSON.parse(localStorage.getItem('currentUser') || 'null'); }
  function setCurrentUser(u){ localStorage.setItem('currentUser', JSON.stringify(u)); updateAuthUI(); }
  function doLogin(){
    const email = document.getElementById('authEmail').value.trim();
    const pass = document.getElementById('authPass').value;
    if(!email || !pass){ alert('Ø£ÙƒÙ…Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„'); return; }
    const users = JSON.parse(localStorage.getItem('users') || '[]');
    const found = users.find(x=> (x.email===email || x.username===email) && x.pass===pass);
    if(found){
      setCurrentUser(found);
      closeAuth();
      alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø³ØªØ®Ø¯Ù…: '+(found.username||found.email));
      if(found.role==='admin'){ showAdminPanel(); }
    } else {
      alert('Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø© Ø£Ùˆ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„');
    }
  }

  function showRegisterForm(){
    document.getElementById('loginForm').classList.add('hidden');
    document.getElementById('registerForm').classList.remove('hidden');
    document.getElementById('authTitle').innerText = 'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨';
  }
  function showLoginForm(){
    document.getElementById('loginForm').classList.remove('hidden');
    document.getElementById('registerForm').classList.add('hidden');
    document.getElementById('authTitle').innerText = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
  }

  function doRegister(){
    const email = document.getElementById('regEmail').value.trim();
    const username = document.getElementById('regUsername').value.trim();
    const pass = document.getElementById('regPass').value;
    const adminCode = document.getElementById('regAdminCode').value.trim();

    if(!email || !username || !pass){ alert('Ø£ÙƒÙ…Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„'); return; }
    const users = JSON.parse(localStorage.getItem('users') || '[]');
    if(users.find(u=>u.email===email)){ alert('Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„'); return; }

    let role = 'student';
    if(adminCode && adminCode === ADMIN_CODE){
      role = 'admin';
    }
    const newUser = { email, username, pass, role };
    users.push(newUser);
    localStorage.setItem('users', JSON.stringify(users));
    alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­. Ø§Ù„Ø¯ÙˆØ±: ' + role);
    setCurrentUser(newUser);
    closeAuth();
    if(role === 'admin') showAdminPanel();
  }

  function openAuth(){ document.getElementById('authModal').classList.remove('hidden'); showLoginForm(); }
  function closeAuth(){ document.getElementById('authModal').classList.add('hidden'); }

  function updateAuthUI(){
    const cur = getCurrentUser();
    document.getElementById('btnLogin').innerText = cur ? (cur.username || cur.email) : 'ØªØ³Ø¬ÙŠÙ„/Ø¯Ø®ÙˆÙ„';
    document.getElementById('btnDashboard').classList.toggle('hidden', !(cur && cur.role==='admin'));
  }

  function showAdminPanel(){
    const cur = getCurrentUser();
    if(!cur || cur.role!=='admin'){ alert('Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ† Ù…Ù‚ÙÙ„Ø© â€” Ø³Ø¬Ù‘Ù„ ÙƒÙ…Ø´Ø±Ù Ù„Ø¹Ø±Ø¶Ù‡Ø§'); return; }
    showSection('admin'); document.getElementById('adminPanel').classList.remove('hidden');
    renderAdminButtonsList(); renderAdminQuestions(); renderSales(); renderAdminCoursesList(); renderNewsList();
  }

  // bindings
  document.getElementById('btnLogin').addEventListener('click', ()=> openAuth());
  document.getElementById('btnDashboard').addEventListener('click', ()=> showAdminPanel());

  // initial render
  renderCourses();
  renderCourseButtons();
  renderAdminQuestions();
  renderSales();
  renderAdminCoursesList();
  renderNewsList();
  updateAuthUI();

</script>


<div id="adminPanel" style="display:none;position:fixed;top:0;right:0;width:350px;height:100%;background:#fff;box-shadow:-2px 0 5px rgba(0,0,0,0.3);padding:10px;z-index:9000;overflow:auto;">
  <h3 style="text-align:center;">ğŸ› ï¸ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ†</h3>
  <div style="display:flex;gap:5px;justify-content:space-around;margin-bottom:10px;">
    <button onclick="openTab('coursesTab')">ğŸ“ Ø§Ù„Ø¯ÙˆØ±Ø§Øª</button>
    <button onclick="openTab('newsTab')">ğŸ–¼ï¸ Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</button>
    <button onclick="openTab('buttonsTab')">ğŸ”˜ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª</button>
    <button onclick="openTab('questionsTab')">â“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</button>
    <button onclick="openTab('salesTab')">ğŸ’° Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</button>
  </div>
  <div id="coursesTab" class="adminTab" style="display:none;">
    <h4>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ±Ø§Øª</h4>
    <div id="coursesList"></div>
    <input type="text" id="newCourseName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ±Ø©">
    <button onclick="addCourse()">â• Ø¥Ø¶Ø§ÙØ©</button>
  </div>
  <div id="newsTab" class="adminTab" style="display:none;">
    <h4>Ø¥Ø¯Ø§Ø±Ø© ØµÙˆØ± Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</h4>
    <div id="newsList"></div>
    <input type="text" id="newNewsURL" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©">
    <button onclick="addNews()">â• Ø¥Ø¶Ø§ÙØ©</button>
  </div>
  <div id="buttonsTab" class="adminTab" style="display:none;">
    <h4>Ø¥Ø¯Ø§Ø±Ø© Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª</h4>
    <div id="buttonsList"></div>
    <input type="text" id="newButtonName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø²Ø±">
    <button onclick="addButton()">â• Ø¥Ø¶Ø§ÙØ©</button>
  </div>
  <div id="questionsTab" class="adminTab" style="display:none;">
    <h4>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</h4>
    <div id="questionsList"></div>
    <input type="text" id="newQuestion" placeholder="Ø§Ù„Ø³Ø¤Ø§Ù„">
    <button onclick="addQuestion()">â• Ø¥Ø¶Ø§ÙØ©</button>
  </div>
  <div id="salesTab" class="adminTab" style="display:none;">
    <h4>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</h4>
    <div id="salesList"></div>
  </div>
</div>

<button id="adminToggleBtn" style="display:none;position:fixed;top:20px;right:20px;z-index:9001;">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ†</button>


<script>
const firebaseConfig = {
  apiKey: "AIzaSyB4_41AcIGnlxFVT7XYGfFFCtGQZmFj0tI",
  authDomain: "tawiq-f8d65.firebaseapp.com",
  projectId: "tawiq-f8d65",
  storageBucket: "tawiq-f8d65.firebasestorage.app",
  messagingSenderId: "47258312484",
  appId: "1:47258312484:web:588d01bd2d7fd560e49db1",
  measurementId: "G-4JXWGDD0HY"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

let isRegister = false;
document.getElementById('toggleAuth').onclick = () => {
  isRegister = !isRegister;
  document.getElementById('authTitle').innerText = isRegister ? 'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨' : 'ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„';
  document.getElementById('authAction').innerText = isRegister ? 'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨' : 'ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„';
  document.getElementById('adminCode').style.display = isRegister ? 'block' : 'none';
  document.getElementById('toggleAuth').innerText = isRegister ? 'Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„' : 'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯';
};

document.getElementById('authAction').onclick = () => {
  const email = document.getElementById('email').value;
  const pass = document.getElementById('password').value;
  const adminCode = document.getElementById('adminCode').value;
  if (isRegister) {
    auth.createUserWithEmailAndPassword(email, pass).then(cred => {
      db.ref('profiles/' + cred.user.uid).set({email: email});
      if (adminCode === 'moshrif192837465') {
        db.ref('admins/' + cred.user.uid).set(true);
      }
    }).catch(alert);
  } else {
    auth.signInWithEmailAndPassword(email, pass).catch(alert);
  }
};

auth.onAuthStateChanged(user => {
  if (user) {
    document.getElementById('authModal').style.display = 'none';
    db.ref('admins/' + user.uid).once('value').then(snap => {
      if (snap.val()) {
        document.getElementById('adminToggleBtn').style.display = 'block';
      }
    });
  } else {
    document.getElementById('authModal').style.display = 'flex';
    document.getElementById('adminToggleBtn').style.display = 'none';
    document.getElementById('adminPanel').style.display = 'none';
  }
});

document.getElementById('adminToggleBtn').onclick = () => {
  const panel = document.getElementById('adminPanel');
  panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
};
</script>


<script>
function openTab(tabId) {
  document.querySelectorAll('.adminTab').forEach(tab => tab.style.display = 'none');
  document.getElementById(tabId).style.display = 'block';
}

// Courses
function loadCourses() {
  firebase.database().ref('courses').on('value', snap => {
    const list = document.getElementById('coursesList');
    list.innerHTML = '';
    const data = snap.val() || {};
    Object.keys(data).forEach(key => {
      const div = document.createElement('div');
      div.textContent = data[key].name || 'Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…';
      const delBtn = document.createElement('button');
      delBtn.textContent = 'ğŸ—‘ï¸';
      delBtn.onclick = () => {
        if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆØ±Ø©ØŸ')) {
          firebase.database().ref('courses/' + key).remove();
        }
      };
      div.appendChild(delBtn);
      list.appendChild(div);
    });
  });
}
function addCourse() {
  const name = document.getElementById('newCourseName').value;
  if (!name) return alert('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ±Ø©');
  const key = firebase.database().ref().child('courses').push().key;
  firebase.database().ref('courses/' + key).set({name});
  document.getElementById('newCourseName').value = '';
}

// News
function loadNews() {
  firebase.database().ref('newsImages').on('value', snap => {
    const list = document.getElementById('newsList');
    list.innerHTML = '';
    const data = snap.val() || {};
    Object.keys(data).forEach(key => {
      const div = document.createElement('div');
      div.innerHTML = '<img src="'+data[key]+'" style="width:50px;height:50px;">';
      const delBtn = document.createElement('button');
      delBtn.textContent = 'ğŸ—‘ï¸';
      delBtn.onclick = () => {
        if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„ØµÙˆØ±Ø©ØŸ')) {
          firebase.database().ref('newsImages/' + key).remove();
        }
      };
      div.appendChild(delBtn);
      list.appendChild(div);
    });
  });
}
function addNews() {
  const url = document.getElementById('newNewsURL').value;
  if (!url) return alert('Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©');
  const key = firebase.database().ref().child('newsImages').push().key;
  firebase.database().ref('newsImages/' + key).set(url);
  document.getElementById('newNewsURL').value = '';
}

// Buttons
function loadButtons() {
  firebase.database().ref('courseButtons').on('value', snap => {
    const list = document.getElementById('buttonsList');
    list.innerHTML = '';
    const data = snap.val() || {};
    Object.keys(data).forEach(key => {
      const div = document.createElement('div');
      div.textContent = data[key];
      const delBtn = document.createElement('button');
      delBtn.textContent = 'ğŸ—‘ï¸';
      delBtn.onclick = () => {
        if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø²Ø±ØŸ')) {
          firebase.database().ref('courseButtons/' + key).remove();
        }
      };
      div.appendChild(delBtn);
      list.appendChild(div);
    });
  });
}
function addButton() {
  const name = document.getElementById('newButtonName').value;
  if (!name) return alert('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø²Ø±');
  const key = firebase.database().ref().child('courseButtons').push().key;
  firebase.database().ref('courseButtons/' + key).set(name);
  document.getElementById('newButtonName').value = '';
}

// Questions
function loadQuestions() {
  firebase.database().ref('adminQuestions').on('value', snap => {
    const list = document.getElementById('questionsList');
    list.innerHTML = '';
    const data = snap.val() || {};
    Object.keys(data).forEach(key => {
      const div = document.createElement('div');
      div.textContent = data[key];
      const delBtn = document.createElement('button');
      delBtn.textContent = 'ğŸ—‘ï¸';
      delBtn.onclick = () => {
        if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¤Ø§Ù„ØŸ')) {
          firebase.database().ref('adminQuestions/' + key).remove();
        }
      };
      div.appendChild(delBtn);
      list.appendChild(div);
    });
  });
}
function addQuestion() {
  const q = document.getElementById('newQuestion').value;
  if (!q) return alert('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„');
  const key = firebase.database().ref().child('adminQuestions').push().key;
  firebase.database().ref('adminQuestions/' + key).set(q);
  document.getElementById('newQuestion').value = '';
}

// Sales
function loadSales() {
  firebase.database().ref('sales').on('value', snap => {
    const list = document.getElementById('salesList');
    list.innerHTML = '';
    const data = snap.val() || {};
    Object.keys(data).forEach(key => {
      const div = document.createElement('div');
      div.textContent = JSON.stringify(data[key]);
      const delBtn = document.createElement('button');
      delBtn.textContent = 'ğŸ—‘ï¸';
      delBtn.onclick = () => {
        if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©ØŸ')) {
          firebase.database().ref('sales/' + key).remove();
        }
      };
      div.appendChild(delBtn);
      list.appendChild(div);
    });
  });
}

// Load data when opening tabs
document.getElementById('adminToggleBtn').addEventListener('click', () => {
  const panel = document.getElementById('adminPanel');
  panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
});

</script>

</body>
<footer style="background-color: green;">
  <footer  class="border-t mt-12">
<div style="display:flex;align-items:center;justify-content:center;background-color:green;padding:10px;gap:15px;">
  <img src="https://i.ibb.co/Cyd52rq/Chat-GPT-Image-Aug-11-2025-08-36-12-PM.png" alt="Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰" style="height:40px;"> 
  <span style="max-width:500px;text-align:center;color:white;"> Ù…Ù†ØµØ© Ø·ÙˆÙŠÙ‚ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù‡ÙŠ Ù…Ø³Ø§Ø­Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù…ØµÙ…Ù…Ø© Ø®ØµÙŠØµÙ‹Ø§ Ù„Ø¯Ø¹Ù… Ø§Ù„Ø·Ù„Ø§Ø¨ ÙÙŠ Ø§Ø¬ØªÙŠØ§Ø² Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù‚Ø¯Ø±Ø§Øª Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ«Ù‚Ø©ØŒ ÙˆØªÙ‚Ø¯Ù… Ø§Ù„Ù…Ù†ØµØ© Ù…Ø¬Ù…ÙˆØ¹Ø© ÙˆØ§Ø³Ø¹Ø© Ù…Ù† Ø§Ù„Ø£Ø¯ÙˆØ§Øª ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª Ù…Ø«Ù„ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù…Ø®ØµØµØ© ÙˆÙ…Ù„ÙØ§Øª Ù…ØªÙ†ÙˆØ¹Ø© Ù„Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆÙ…Ù„Ø®ØµØ§Øª Ù„ØªØ³Ø§Ø¹Ø¯Ùƒ Ø¹Ù„Ù‰ ØªØ­Ø³ÙŠÙ† Ù…Ø³ØªÙˆØ§Ùƒ Ø¨Ø³Ø±Ø¹Ø© ÙˆØ¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ù†Ø¸Ù…Ø©. Ù…Ø¹ Ø·ÙˆÙŠÙ‚ØŒ Ø³ØªØ¬Ø¯ ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡ Ù„ØªØªØ¹Ù„Ù… Ø¨ÙƒÙØ§Ø¡Ø© ÙˆØªØ­Ù‚Ù‚ Ø­Ù„Ù…Ùƒ Ø¨Ø¥Ø°Ù† Ø§Ù„Ù„Ù‡ </span> 
  <img src="https://i.ibb.co/Cyd52rq/Chat-GPT-Image-Aug-11-2025-08-36-12-PM.png" alt="Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©" style="height:40px;">
</div>
  </footer>
</footer>
</html>












































